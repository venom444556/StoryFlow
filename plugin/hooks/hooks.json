{
  "description": "StoryFlow closed-loop board sync — dispatches the storyflow-agent to keep the board in sync with actual work",
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "TaskUpdate",
        "hooks": [
          {
            "type": "command",
            "command": "input=$(cat); if echo \"$input\" | grep -q '\"completed\"'; then echo 'Task completed. Invoke the storyflow-agent to move the corresponding issue to Done on the StoryFlow board. Pass it the task subject and completion details.'; elif echo \"$input\" | grep -q '\"in_progress\"'; then echo 'Task started. Invoke the storyflow-agent to ensure this task has a corresponding issue on the StoryFlow board and set it to In Progress.'; fi",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "ExitPlanMode",
        "hooks": [
          {
            "type": "command",
            "command": "echo 'Plan approved. Invoke the storyflow-agent to create issues from the plan on the StoryFlow board and set them to In Progress. Pass it the plan details.'",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "input=$(cat); if echo \"$input\" | grep -qE 'git commit'; then echo 'Commit detected. Invoke the storyflow-agent to update the StoryFlow board — pass it the commit message so it can mark completed issues as Done.'; fi",
            "timeout": 5
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "echo 'Session ending. Invoke the storyflow-agent to reconcile the StoryFlow board before stopping. If StoryFlow is not configured or unreachable, skip silently.'",
            "timeout": 5
          }
        ]
      }
    ]
  }
}
